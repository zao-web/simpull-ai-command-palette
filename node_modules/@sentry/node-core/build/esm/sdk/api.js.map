{"version":3,"file":"api.js","sources":["../../../src/sdk/api.ts"],"sourcesContent":["// PUBLIC APIS\n\nimport type { StackParser } from '@sentry/core';\nimport { createStackParser, GLOBAL_OBJ, nodeStackLineParser } from '@sentry/core';\nimport { createGetModuleFromFilename } from '../utils/module';\n\n/**\n * Returns a release dynamically from environment variables.\n */\n// eslint-disable-next-line complexity\nexport function getSentryRelease(fallback?: string): string | undefined {\n  // Always read first as Sentry takes this as precedence\n  if (process.env.SENTRY_RELEASE) {\n    return process.env.SENTRY_RELEASE;\n  }\n\n  // This supports the variable that sentry-webpack-plugin injects\n  if (GLOBAL_OBJ.SENTRY_RELEASE?.id) {\n    return GLOBAL_OBJ.SENTRY_RELEASE.id;\n  }\n\n  // This list is in approximate alpha order, separated into 3 categories:\n  // 1. Git providers\n  // 2. CI providers with specific environment variables (has the provider name in the variable name)\n  // 3. CI providers with generic environment variables (checked for last to prevent possible false positives)\n\n  const possibleReleaseNameOfGitProvider =\n    // GitHub Actions - https://help.github.com/en/actions/configuring-and-managing-workflows/using-environment-variables#default-environment-variables\n    process.env['GITHUB_SHA'] ||\n    // GitLab CI - https://docs.gitlab.com/ee/ci/variables/predefined_variables.html\n    process.env['CI_MERGE_REQUEST_SOURCE_BRANCH_SHA'] ||\n    process.env['CI_BUILD_REF'] ||\n    process.env['CI_COMMIT_SHA'] ||\n    // Bitbucket - https://support.atlassian.com/bitbucket-cloud/docs/variables-and-secrets/\n    process.env['BITBUCKET_COMMIT'];\n\n  const possibleReleaseNameOfCiProvidersWithSpecificEnvVar =\n    // AppVeyor - https://www.appveyor.com/docs/environment-variables/\n    process.env['APPVEYOR_PULL_REQUEST_HEAD_COMMIT'] ||\n    process.env['APPVEYOR_REPO_COMMIT'] ||\n    // AWS CodeBuild - https://docs.aws.amazon.com/codebuild/latest/userguide/build-env-ref-env-vars.html\n    process.env['CODEBUILD_RESOLVED_SOURCE_VERSION'] ||\n    // AWS Amplify - https://docs.aws.amazon.com/amplify/latest/userguide/environment-variables.html\n    process.env['AWS_COMMIT_ID'] ||\n    // Azure Pipelines - https://docs.microsoft.com/en-us/azure/devops/pipelines/build/variables?view=azure-devops&tabs=yaml\n    process.env['BUILD_SOURCEVERSION'] ||\n    // Bitrise - https://devcenter.bitrise.io/builds/available-environment-variables/\n    process.env['GIT_CLONE_COMMIT_HASH'] ||\n    // Buddy CI - https://buddy.works/docs/pipelines/environment-variables#default-environment-variables\n    process.env['BUDDY_EXECUTION_REVISION'] ||\n    // Builtkite - https://buildkite.com/docs/pipelines/environment-variables\n    process.env['BUILDKITE_COMMIT'] ||\n    // CircleCI - https://circleci.com/docs/variables/\n    process.env['CIRCLE_SHA1'] ||\n    // Cirrus CI - https://cirrus-ci.org/guide/writing-tasks/#environment-variables\n    process.env['CIRRUS_CHANGE_IN_REPO'] ||\n    // Codefresh - https://codefresh.io/docs/docs/codefresh-yaml/variables/\n    process.env['CF_REVISION'] ||\n    // Codemagic - https://docs.codemagic.io/yaml-basic-configuration/environment-variables/\n    process.env['CM_COMMIT'] ||\n    // Cloudflare Pages - https://developers.cloudflare.com/pages/platform/build-configuration/#environment-variables\n    process.env['CF_PAGES_COMMIT_SHA'] ||\n    // Drone - https://docs.drone.io/pipeline/environment/reference/\n    process.env['DRONE_COMMIT_SHA'] ||\n    // Flightcontrol - https://www.flightcontrol.dev/docs/guides/flightcontrol/environment-variables#built-in-environment-variables\n    process.env['FC_GIT_COMMIT_SHA'] ||\n    // Heroku #1 https://devcenter.heroku.com/articles/heroku-ci\n    process.env['HEROKU_TEST_RUN_COMMIT_VERSION'] ||\n    // Heroku #2 https://docs.sentry.io/product/integrations/deployment/heroku/#configure-releases\n    process.env['HEROKU_SLUG_COMMIT'] ||\n    // Railway - https://docs.railway.app/reference/variables#git-variables\n    process.env['RAILWAY_GIT_COMMIT_SHA'] ||\n    // Render - https://render.com/docs/environment-variables\n    process.env['RENDER_GIT_COMMIT'] ||\n    // Semaphore CI - https://docs.semaphoreci.com/ci-cd-environment/environment-variables\n    process.env['SEMAPHORE_GIT_SHA'] ||\n    // TravisCI - https://docs.travis-ci.com/user/environment-variables/#default-environment-variables\n    process.env['TRAVIS_PULL_REQUEST_SHA'] ||\n    // Vercel - https://vercel.com/docs/v2/build-step#system-environment-variables\n    process.env['VERCEL_GIT_COMMIT_SHA'] ||\n    process.env['VERCEL_GITHUB_COMMIT_SHA'] ||\n    process.env['VERCEL_GITLAB_COMMIT_SHA'] ||\n    process.env['VERCEL_BITBUCKET_COMMIT_SHA'] ||\n    // Zeit (now known as Vercel)\n    process.env['ZEIT_GITHUB_COMMIT_SHA'] ||\n    process.env['ZEIT_GITLAB_COMMIT_SHA'] ||\n    process.env['ZEIT_BITBUCKET_COMMIT_SHA'];\n\n  const possibleReleaseNameOfCiProvidersWithGenericEnvVar =\n    // CloudBees CodeShip - https://docs.cloudbees.com/docs/cloudbees-codeship/latest/pro-builds-and-configuration/environment-variables\n    process.env['CI_COMMIT_ID'] ||\n    // Coolify - https://coolify.io/docs/knowledge-base/environment-variables\n    process.env['SOURCE_COMMIT'] ||\n    // Heroku #3 https://devcenter.heroku.com/changelog-items/630\n    process.env['SOURCE_VERSION'] ||\n    // Jenkins - https://plugins.jenkins.io/git/#environment-variables\n    process.env['GIT_COMMIT'] ||\n    // Netlify - https://docs.netlify.com/configure-builds/environment-variables/#build-metadata\n    process.env['COMMIT_REF'] ||\n    // TeamCity - https://www.jetbrains.com/help/teamcity/predefined-build-parameters.html\n    process.env['BUILD_VCS_NUMBER'] ||\n    // Woodpecker CI - https://woodpecker-ci.org/docs/usage/environment\n    process.env['CI_COMMIT_SHA'];\n\n  return (\n    possibleReleaseNameOfGitProvider ||\n    possibleReleaseNameOfCiProvidersWithSpecificEnvVar ||\n    possibleReleaseNameOfCiProvidersWithGenericEnvVar ||\n    fallback\n  );\n}\n\n/** Node.js stack parser */\nexport const defaultStackParser: StackParser = createStackParser(nodeStackLineParser(createGetModuleFromFilename()));\n"],"names":[],"mappings":"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"}